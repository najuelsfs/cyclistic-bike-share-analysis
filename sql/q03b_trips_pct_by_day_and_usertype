Objective: Obtain the number of trips per day by user type.
SELECT 
day_of_week,
usertype,
COUNT(*) AS trips,
ROUND(
  COUNT(*) / SUM(count(*)) OVER (PARTITION BY day_of_week)*100,2)
   AS pct_trips
FROM(
  SELECT
    CASE EXTRACT(DAYOFWEEK FROM start_time)
    WHEN 1 THEN 'sunday'
    WHEN 2 THEN 'monday'
    WHEN 3 THEN 'tusday'
    WHEN 4 THEN 'wednesday'
    WHEN 5 THEN 'thursday'
    WHEN 6 THEN 'friday'
    WHEN 7 THEN 'saturday'
    END AS day_of_week,
    usertype
  FROM `sylvan-pivot-479415-f9.cyclistic.Trips_2019_2020` 
   WHERE tripduration_min BETWEEN 1 AND 1440
)
   GROUP BY day_of_week, usertype
   Order BY day_of_week, usertype;
